#
# database file for the HTS magnet Smart Monitor
#
record(bo, "$(P)SIM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
    field(ZNAM, "NO")
    field(ONAM, "YES")
    field(VAL, "$(RECSIM=0)")
    field(PINI, "YES")
}
record(bo, "$(P)DISABLE")
{
    field(DESC, "Disable comms")
    field(PINI, "YES")
    field(VAL, "$(DISABLE=0)")
    field(OMSL, "supervisory")
    field(ZNAM, "COMMS ENABLED")
    field(ONAM, "COMMS DISABLED")
}

# Buffer for STAT, LIMS and OPLM commands
# Using INPL to propagate alarms
record(calc, "$(P)STATBUFFER")
{
	field(CALC, "0")
	field(INPL, "$(P)STAT MS")
}
record(calc, "$(P)LIMSBUFFER")
{
	field(CALC, "0")
	field(INPL, "$(P)LIMS MS")
}
record(calc, "$(P)OPLMBUFFER")
{
	field(CALC, "0")
	field(INPL, "$(P)OPLM MS")
}

# STAT, LIMS and OPLM commands
record(bi, "$(P)STAT")
{
	field(INP, "@SMRTMON.proto getStat($(P)STATBUFFER) $(PORT)")
    field(SCAN, "1 second")
    field(DTYP, "stream")
    field(SDIS, "$(P)DISABLE")
	field(FLNK, "$(P)STATBUFFER")
}
record(bi, "$(P)LIMS")
{
	field(INP, "@SMRTMON.proto getLims($(P)LIMSBUFFER) $(PORT)")
    field(SCAN, "1 second")
    field(DTYP, "stream")
    field(SDIS, "$(P)DISABLE")
	field(FLNK, "$(P)LIMSBUFFER")
}
record(bi, "$(P)OPLM")
{
	field(INP, "@SMRTMON.proto getOplm($(P)OPLMBUFFER) $(PORT)")
    field(SCAN, "1 second")
    field(DTYP, "stream")
    field(SDIS, "$(P)DISABLE")
	field(FLNK, "$(P)OPLMBUFFER")
}

# Filtered PVs
record(ai, "$(P)TEMP1")
{
	field(INP, "$(P)STATBUFFER.A CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP1")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)TEMP2")
{
	field(INP, "$(P)STATBUFFER.B CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP2")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)TEMP3")
{
	field(INP, "$(P)STATBUFFER.C CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP3")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)TEMP4")
{
	field(INP, "$(P)STATBUFFER.D CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP4")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)TEMP5")
{
	field(INP, "$(P)STATBUFFER.E CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP5")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)TEMP6")
{
	field(INP, "$(P)STATBUFFER.F CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP6")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)VOLT1")
{
	field(INP, "$(P)STATBUFFER.G CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT1")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)VOLT2")
{
	field(INP, "$(P)STATBUFFER.H CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT2")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)VOLT3")
{
	field(INP, "$(P)STATBUFFER.I CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT3")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
	info(alarm, "SMRTMON")
}
record(ai, "$(P)MI")
{
	field(INP, "$(P)STATBUFFER.J CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:MI")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
}
record(ai, "$(P)STATUS")
{
	field(INP, "$(P)STATBUFFER.K CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:STATUS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
}

# OPLMS
record(ai, "$(P)TEMP1:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.A CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP1:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP2:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.B CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP2:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP3:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.C CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP3:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP4:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.D CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP4:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP5:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.E CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP5:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP6:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.F CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP6:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)VOLT1:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.G CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT1:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)VOLT2:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.H CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT2:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)VOLT3:OPLM")
{
	field(INP, "$(P)OPLMBUFFER.I CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT3:OPLM")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}

# LIMS
record(ai, "$(P)TEMP1:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.A CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP1:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP2:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.B CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP2:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP3:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.C CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP3:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP4:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.D CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP4:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP5:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.E CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP5:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)TEMP6:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.F CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:TEMP6:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)VOLT1:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.G CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT1:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)VOLT2:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.H CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT2:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}
record(ai, "$(P)VOLT3:LIMS")
{
	field(INP, "$(P)LIMSBUFFER.I CP MS")
    field(DTYP, "Soft Channel")
    field(SIML, "$(P)SIM")
    field(SIOL, "$(P)SIM:VOLT3:LIMS")
    field(SDIS, "$(P)DISABLE")
	info(INTEREST, "MEDIUM")
	info(archive, "VAL")
}

# Enum for magnet status
record(mbbi, "$(P)MAGNETSTATUS")
{
	field("INP", "$(P)STATUS CP")
    field(DTYP, "Soft Channel")
	field(ZRVL, "0")
	field(ONVL, "1")
	field(TWVL, "2")
	field(THVL, "3")
	field(FRVL, "4")
	field(ZRST, "")
	field(ONST, "At Room Temperature")
	field(TWST, "Cooling Down")
	field(THST, "At Operating Temperature")
	field(FRST, "A Fault Has Occurred")
	info(INTEREST, "HIGH")
	info(archive, "VAL")
}

# SIM records
record(ai, "$(P)SIM:TEMP1")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP2")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP3")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP4")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP5")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP6")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT1")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT2")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT3")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}

record(ai, "$(P)SIM:TEMP1:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP2:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP3:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP4:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP5:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP6:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT1:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT2:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT3:OPLM")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}

record(ai, "$(P)SIM:TEMP1:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP2:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP3:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP4:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP5:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:TEMP6:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT1:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT2:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:VOLT3:LIMS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}

record(ai, "$(P)SIM:STATUS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(ai, "$(P)SIM:MI")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}
record(mbbi, "$(P)SIM:MAGNETSTATUS")
{
    field(SCAN, "Passive")
    field(DTYP, "Soft Channel")
}

